
{% extends "layout.html" %}

{% block content %}
<div class="profile-container">
  <div class="profile-header-section">
    <div class="profile-banner">
      <div class="profile-avatar-wrapper">
        {% if user.avatar_url %}
          <img src="{{ user.avatar_url }}" alt="Profil" class="profile-avatar">
        {% else %}
          <div class="default-avatar">
            {{ user.username[0].upper() }}
          </div>
        {% endif %}
      </div>
      <div class="profile-basic-info">
        <h1>{{ user.username }}</h1>
        <span class="user-level">{{ user.rank }}</span>
        <p class="join-date">Katılım: {{ user.created_at.strftime('%d %B %Y') }}</p>
      </div>
    </div>
  </div>

  <div class="profile-content">
    <div class="profile-sidebar">
      <div class="profile-card">
        <h3>Kişisel Bilgiler</h3>
        <div class="profile-info-item">
          <i class="fas fa-user"></i>
          <span>{{ user.full_name or 'İsim belirtilmedi' }}</span>
        </div>
        <div class="profile-info-item">
          <i class="fas fa-envelope"></i>
          <span>{{ user.email }}</span>
        </div>
        <div class="profile-info-item">
          <i class="fas fa-map-marker-alt"></i>
          <span>{{ user.location or 'Konum belirtilmedi' }}</span>
        </div>
        <div class="profile-info-item">
          <i class="fas fa-calendar"></i>
          <span>{{ user.age or 'Yaş belirtilmedi' }} yaş</span>
        </div>
        <button class="edit-profile-btn" data-bs-toggle="modal" data-bs-target="#editProfileModal">
          <i class="fas fa-edit"></i> Profili Düzenle
        </button>
      </div>

      <div class="stats-card">
        <h3>İstatistikler</h3>
        <div class="stat-item">
          <div class="stat-icon"><i class="fas fa-trophy"></i></div>
          <div class="stat-info">
            <span class="stat-value">{{ user.highest_score }}</span>
            <span class="stat-label">En Yüksek Skor</span>
          </div>
        </div>
        <div class="stat-item">
          <div class="stat-icon"><i class="fas fa-gamepad"></i></div>
          <div class="stat-info">
            <span class="stat-value">{{ user.total_games_played }}</span>
            <span class="stat-label">Toplam Oyun</span>
          </div>
        </div>
        <div class="stat-item">
          <div class="stat-icon"><i class="fas fa-star"></i></div>
          <div class="stat-info">
            <span class="stat-value">{{ user.experience_points }}</span>
            <span class="stat-label">XP</span>
          </div>
        </div>
      </div>
    </div>

    <div class="profile-main">
      <div class="recent-activity-card">
        <h3>Son Aktiviteler</h3>
        <div class="activity-list">
          {% for score in recent_scores %}
          <div class="activity-item">
            <div class="activity-game">
              <i class="fas fa-gamepad"></i>
              <span>{{ score.game_type }}</span>
            </div>
            <div class="activity-score">{{ score.score }} puan</div>
            <div class="activity-date">{{ score.timestamp.strftime('%d/%m/%Y %H:%M') }}</div>
          </div>
          {% endfor %}
        </div>
      </div>

      <div class="achievements-card">
        <h3>Başarılar</h3>
        <div class="achievements-grid">
          <div class="achievement-item locked">
            <i class="fas fa-medal"></i>
            <span>İlk 1000 Puan</span>
          </div>
          <div class="achievement-item {% if user.highest_score >= 5000 %}unlocked{% else %}locked{% endif %}">
            <i class="fas fa-trophy"></i>
            <span>5000 Puan Rozeti</span>
          </div>
          <div class="achievement-item {% if user.total_games_played >= 100 %}unlocked{% else %}locked{% endif %}">
            <i class="fas fa-gamepad"></i>
            <span>100 Oyun Tamamlandı</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Profil Düzenleme Modal -->
<div class="modal fade" id="editProfileModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Profili Düzenle</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="profileEditForm" action="{{ url_for('update_profile') }}" method="POST">
          <div class="mb-3">
            <label class="form-label">Tam Ad</label>
            <input type="text" class="form-control" name="full_name" value="{{ user.full_name or '' }}">
          </div>
          <div class="mb-3">
            <label class="form-label">Yaş</label>
            <input type="number" class="form-control" name="age" value="{{ user.age or '' }}">
          </div>
          <div class="mb-3">
            <label class="form-label">Konum</label>
            <input type="text" class="form-control" name="location" value="{{ user.location or '' }}">
          </div>
          <div class="mb-3">
            <label class="form-label">Biyografi</label>
            <textarea class="form-control" name="bio" rows="3">{{ user.bio or '' }}</textarea>
          </div>
          <div class="mb-3">
            <label class="form-label">Profil Resmi URL</label>
            <input type="url" class="form-control" name="avatar_url" value="{{ user.avatar_url or '' }}">
          </div>
          <button type="submit" class="btn btn-primary w-100">Kaydet</button>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}
