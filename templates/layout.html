<!DOCTYPE html>
<html lang="tr" class="{{ get_user_data().theme_preference if get_user_data() else 'dark' }}">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="max-age=31536000, immutable">
<meta name="turbo-cache-control" content="no-preview">
<title>{% block title %}OmGame - Bilişsel Beceri Oyunları{% endblock %}</title>
<link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"></noscript>
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet"></noscript>

<!-- Optimize edilmiş CSS yükleme -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
<link rel="preload" href="{{ url_for('static', filename='css/auth.css') }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="{{ url_for('static', filename='css/games.css') }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="{{ url_for('static', filename='css/game-components.css') }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="{{ url_for('static', filename='css/leaderboard.css') }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="{{ url_for('static', filename='css/navbar-fixes.css') }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="{{ url_for('static', filename='css/profile_new.css') }}" as="style" onload="this.onload=null;this.rel='stylesheet'">

<!-- Hızlı yükleme için CSS önbelleğe alma için yardımcı script -->
<script>
// CSS önbelleğe alma yardımcı fonksiyonu
(function() {
  // Tarayıcı önbelleğini güçlendirme
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', function() {
      navigator.serviceWorker.register('/static/sw.js').then(function() {
        console.log('ServiceWorker kayıtlı');
      }, function(err) {
        console.log('ServiceWorker kaydı başarısız: ', err);
      });
    });
  }
  
  // CSS gecikmeli yükleme yardımcısı
  var cssLoader = function() {
    var l = document.createElement('link');
    var r = document.createElement('link');
    
    l.rel = 'stylesheet';
    l.href = '{{ url_for('static', filename='css/defer.css') }}';
    r.rel = 'prefetch';
    r.as = 'style';
    r.href = '{{ url_for('static', filename='css/prefetch.css') }}';
    
    var h = document.getElementsByTagName('head')[0];
    h.appendChild(l);
    h.appendChild(r);
  };
  
  // DOM yüklendikten sonra gecikmeli CSS'leri yükle
  if (window.addEventListener) {
    window.addEventListener('DOMContentLoaded', cssLoader, false);
  } else if (window.attachEvent) {
    window.attachEvent('onload', cssLoader);
  } else {
    window.onload = cssLoader;
  }
})();
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Navbar mobile toggle
  const navbarToggler = document.querySelector('.navbar-toggler');
  const navbarCollapse = document.getElementById('navbarSupportedContent');
  
  if (navbarToggler) {
    navbarToggler.addEventListener('click', function() {
      navbarCollapse.classList.toggle('show');
    });
  }

  // Profil dropdown'u için özel event listener ekle
  const userDropdown = document.getElementById('userDropdown');
  if (userDropdown) {
    userDropdown.addEventListener('click', function(e) {
      e.preventDefault();
      e.stopPropagation();
      const dropdown = bootstrap.Dropdown.getInstance(userDropdown) || new bootstrap.Dropdown(userDropdown);
      dropdown.toggle();
    });
  }
});

// Makale ve ipucu içeriklerini dinamik olarak yükleme işlevi
function loadArticleContent() {
  // Burada AJAX ile içerik yüklenebilir
  console.log("İçerik yükleniyor...");
}
</script>

<!-- THREE.js ve ilgili kütüphaneler -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js" defer></script>
<link rel="icon" href="{{ url_for('static', filename='images/logo.png') }}">
<!-- Meta Tags-->
<meta name="description" content="Zihinsel becerilerinizi geliştirmek için bilimsel olarak tasarlanmış bilişsel oyunlar. IQ, hafıza, konsantrasyon ve çözüm odaklı düşünmeyi geliştirin.">
<meta name="keywords" content="OmGame, beyin geliştirme, iq oyunları, zihin oyunları, hafıza geliştirme, bilişsel beceriler">
</head>

<body>
<header>
<nav class="navbar navbar-expand-lg navbar-dark fixed-top">
<div class="container">
  <a class="navbar-brand" href="/">
    <img src="{{ url_for('static', filename='images/logo.png') }}" alt="OmGame Logo" width="40" height="40" class="d-inline-block align-text-center me-2">
    <span class="brand-text">OmGame</span>
  </a>
  
  <button class="navbar-toggler" type="button" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  
  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav me-auto">
      <li class="nav-item"><a class="nav-link {% if request.path == '/' %}active{% endif %}" href="{{ url_for('index') }}"><i class="fas fa-home nav-icon"></i>Ana Sayfa</a></li>
      <li class="nav-item"><a class="nav-link {% if '/games/' in request.path %}active{% endif %}" href="{{ url_for('all_games') }}"><i class="fas fa-gamepad nav-icon"></i>Oyunlar</a></li>
      <li class="nav-item"><a class="nav-link {% if request.path == '/leaderboard' %}active{% endif %}" href="{{ url_for('leaderboard') }}"><i class="fas fa-trophy nav-icon"></i>Liderlik Tablosu</a></li>
      <li class="nav-item"><a class="nav-link {% if request.path == '/articles' %}active{% endif %}" href="{{ url_for('articles') }}"><i class="fas fa-newspaper nav-icon"></i>Makaleler</a></li>
      <li class="nav-item"><a class="nav-link {% if request.path == '/tips' %}active{% endif %}" href="{{ url_for('tips') }}"><i class="fas fa-lightbulb nav-icon"></i>İpuçları</a></li>
      
      {% if session.get('user_id') %}
        <li class="nav-item d-block d-lg-none"><a class="nav-link {% if request.path == '/profile' %}active{% endif %}" href="{{ url_for('profile_v2') }}"><i class="fas fa-user nav-icon"></i>Profilim</a></li>
        <li class="nav-item d-block d-lg-none"><a class="nav-link" href="{{ url_for('logout') }}"><i class="fas fa-sign-out-alt nav-icon"></i>Çıkış Yap</a></li>
      {% endif %}
    </ul>

    <!-- Mobil olmayan ekranlarda kullanıcı dropdown -->
    {% if session.get('user_id') %}
    <div class="dropdown d-none d-lg-block">
      <a href="#" class="nav-link dropdown-toggle user-dropdown-toggle" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        <img src="{{ get_avatar_url() }}" alt="Profil Resmi" class="user-avatar">
        <span class="d-none d-md-inline-block ms-2">{{ get_current_user().username }}</span>
      </a>
      <ul class="dropdown-menu dropdown-menu-end user-dropdown" aria-labelledby="userDropdown">
        <li>
          <div class="dropdown-user-info">
            <img src="{{ get_avatar_url() }}" alt="Profil Resmi" class="dropdown-user-avatar">
            <div class="dropdown-user-details">
              <strong>{{ get_current_user().username }}</strong>
              <span>{{ get_current_user().email }}</span>
            </div>
          </div>
        </li>
        <li><hr class="dropdown-divider"></li>
        <li><a class="dropdown-item" href="{{ url_for('profile_v2') }}"><i class="fas fa-user me-2"></i>Profilim</a></li>
        <li><a class="dropdown-item" href="{{ url_for('leaderboard') }}"><i class="fas fa-trophy me-2"></i>Skorlarım</a></li>
        <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>Ayarlar</a></li>
        <li><hr class="dropdown-divider"></li>
        <li><a class="dropdown-item" href="{{ url_for('logout') }}"><i class="fas fa-sign-out-alt me-2"></i>Çıkış Yap</a></li>
      </ul>
    </div>
    {% endif %}

  <ul class="navbar-nav ms-auto {% if session.get('user_id') %}d-none d-lg-flex{% endif %}">
      {% if not session.get('user_id') %}
        <li class="nav-item"><a class="nav-link {% if request.path == '/login' %}active{% endif %}" href="{{ url_for('login') }}"><i class="fas fa-sign-in-alt nav-icon"></i>Giriş Yap</a></li>
        <li class="nav-item"><a class="nav-link {% if request.path == '/register' %}active{% endif %}" href="{{ url_for('register') }}"><i class="fas fa-user-plus nav-icon"></i>Kayıt Ol</a></li>
      {% endif %}
    </ul>
  </div>
</div>
</nav>
</header>

<main class="container py-4">
{% block content %}

{% endblock %}
</main>

<footer class="footer">
<div class="container">
  <div class="row">
    <div class="col-md-5">
      <h5>OmGame - Bilişsel Gelişim Platformu</h5>
      <p>Beyin gücünüzü ve bilişsel becerilerinizi geliştirmenin en eğlenceli yolu! Düzenli olarak oynadığınızda hafıza, dikkat, odaklanma ve problem çözme becerilerinizi geliştirebilirsiniz.</p>
    </div>
    <div class="col-md-3">
      <h5>Bağlantılar</h5>
      <ul class="footer-links">
        <li><a href="/">Ana Sayfa</a></li>
        <li><a href="{{ url_for('all_games') }}">Oyunlar</a></li>
        <li><a href="{{ url_for('leaderboard') }}">Liderlik Tablosu</a></li>
        <li><a href="{{ url_for('articles') }}">Makaleler</a></li>
        <li><a href="{{ url_for('tips') }}">İpuçları</a></li>
      </ul>
    </div>
    <div class="col-md-4">
      <h5>Bize Ulaşın</h5>
      <ul class="footer-contact">
        <li><i class="fas fa-envelope"></i> <a href="mailto:contact@omgame.com">contact@omgame.com</a></li>
        <li><i class="fas fa-phone"></i> <a href="tel:+901234567890">+90 123 456 78 90</a></li>
        <li><i class="fas fa-map-marker-alt"></i> Teknoloji Vadisi, İstanbul</li>
      </ul>
      <div class="social-icons">
        <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
        <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a>
        <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
        <a href="#" class="social-icon"><i class="fab fa-linkedin-in"></i></a>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-12 text-center mt-4">
      <p class="copyright">© 2023 OmGame. Tüm hakları saklıdır.</p>
    </div>
  </div>
</div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" defer></script>
<!-- Sweet Alert 2 - Gelişmiş ve güzel bildirimler için -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11" defer></script>
<script src="{{ url_for('static', filename='js/main.js') }}" defer></script>
{% block scripts %}{% endblock %}
<!-- iOS 16 UIKit Direkt Port - Gerçek iOS Cihazlarından Birebir Kopya -->
<script src="{{ url_for('static', filename='js/UIKit.js') }}"></script>
</body>
</html>
