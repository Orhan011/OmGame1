{% extends "layout.html" %}

{% block content %}
<div class="container">
  <div class="game-header text-center mb-4">
    <h1>Tangram Bulmaca</h1>
    <p class="text-muted">Geometrik şekilleri birleştirerek belirlenen formları oluşturun</p>
  </div>

  <div class="row">
    <div class="col-lg-10 mx-auto">
      <div class="card mb-4">
        <div class="card-header bg-primary text-white">
          <div class="d-flex justify-content-between align-items-center">
            <h5 class="m-0">Tangram Tahtası</h5>
            <div>
              <span id="level-indicator" class="badge bg-info me-2">Seviye 1</span>
              <span id="timer" class="badge bg-light text-dark">
                <i class="fas fa-clock me-1"></i>00:00
              </span>
            </div>
          </div>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-8">
              <div id="tangram-board" class="mb-3">
                <!-- Hedef form silueti -->
                <div id="target-shape"></div>
                
                <!-- Tangram parçaları -->
                <div id="tangram-pieces">
                  <div class="tangram-piece big-triangle-1" data-shape="big-triangle-1" draggable="true"></div>
                  <div class="tangram-piece big-triangle-2" data-shape="big-triangle-2" draggable="true"></div>
                  <div class="tangram-piece medium-triangle" data-shape="medium-triangle" draggable="true"></div>
                  <div class="tangram-piece small-triangle-1" data-shape="small-triangle-1" draggable="true"></div>
                  <div class="tangram-piece small-triangle-2" data-shape="small-triangle-2" draggable="true"></div>
                  <div class="tangram-piece square" data-shape="square" draggable="true"></div>
                  <div class="tangram-piece parallelogram" data-shape="parallelogram" draggable="true"></div>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="controls-panel">
                <h5 class="mb-3">Kontroller</h5>
                <div class="mb-3">
                  <button id="rotate-left-btn" class="btn btn-sm btn-outline-secondary me-2">
                    <i class="fas fa-undo"></i> 45° Sola Döndür
                  </button>
                  <button id="rotate-right-btn" class="btn btn-sm btn-outline-secondary">
                    <i class="fas fa-redo"></i> 45° Sağa Döndür
                  </button>
                </div>
                <div class="mb-3">
                  <button id="flip-btn" class="btn btn-sm btn-outline-secondary me-2">
                    <i class="fas fa-exchange-alt"></i> Çevir
                  </button>
                  <button id="reset-piece-btn" class="btn btn-sm btn-outline-secondary">
                    <i class="fas fa-sync"></i> Parçayı Sıfırla
                  </button>
                </div>
                <hr />
                <div class="mb-3">
                  <button id="reset-all-btn" class="btn btn-warning mb-2 w-100">
                    <i class="fas fa-sync"></i> Tüm Parçaları Sıfırla
                  </button>
                  <button id="hint-btn" class="btn btn-info mb-2 w-100">
                    <i class="fas fa-lightbulb"></i> İpucu Göster
                  </button>
                  <button id="next-level-btn" class="btn btn-success w-100">
                    <i class="fas fa-arrow-right"></i> Sonraki Seviye
                  </button>
                </div>
                <hr />
                <div class="level-select">
                  <label for="level-select" class="form-label">Seviye Seçin:</label>
                  <select id="level-select" class="form-select mb-2">
                    <option value="1">Seviye 1</option>
                    <option value="2">Seviye 2</option>
                    <option value="3">Seviye 3</option>
                    <option value="4">Seviye 4</option>
                    <option value="5">Seviye 5</option>
                  </select>
                  <button id="load-level-btn" class="btn btn-primary w-100">
                    <i class="fas fa-play"></i> Seçili Seviyeyi Yükle
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="card mb-4">
        <div class="card-header bg-info text-white">
          <h5 class="m-0">Nasıl Oynanır?</h5>
        </div>
        <div class="card-body">
          <p>Tangram, yedi geometrik parçayı kullanarak belirli şekilleri oluşturmaya dayalı eski bir Çin bulmacasıdır.</p>
          <ul>
            <li><strong>Sürükle & Bırak:</strong> Parçaları tahtada istediğiniz konuma sürükleyip bırakabilirsiniz.</li>
            <li><strong>Döndürme:</strong> Bir parçayı seçin ve döndürme butonlarını kullanarak 45 derece döndürün.</li>
            <li><strong>Çevirme:</strong> Bir parça seçin ve çevirme butonuyla yatay eksende çevirin.</li>
            <li><strong>Hedefiniz:</strong> Tüm parçaları kullanarak gri arka planda gösterilen şekli oluşturmaktır.</li>
          </ul>
          <p>Her seviyeyi tamamladığınızda, bir sonraki seviyeye geçebilirsiniz. İpucu butonunu kullanarak zorlandığınız seviyelerde yardım alabilirsiniz!</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Seviye Tamamlama Modalı -->
<div class="modal fade" id="level-complete-modal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Tebrikler!</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="text-center mb-3">
          <i class="fas fa-award fa-3x text-warning"></i>
        </div>
        <p id="level-complete-message">Seviye 1'i başarıyla tamamladınız!</p>
        <div class="result-stats p-3 bg-light rounded">
          <div class="row text-center">
            <div class="col-6">
              <div class="stat-label">Süre</div>
              <div class="stat-value" id="result-time">00:00</div>
            </div>
            <div class="col-6">
              <div class="stat-label">Hamle Sayısı</div>
              <div class="stat-value" id="result-moves">0</div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Kapat</button>
        <button type="button" class="btn btn-primary" id="next-level-modal">Sonraki Seviye</button>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
  /* Tangram tahtası konteynerı */
  #tangram-board {
    position: relative;
    width: 100%;
    height: 500px;
    background-color: #f8f9fa;
    border: 2px solid #dee2e6;
    border-radius: 8px;
    overflow: hidden;
  }
  
  /* Hedef şekil */
  #target-shape {
    position: absolute;
    width: 300px;
    height: 300px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: rgba(200, 200, 200, 0.4);
    z-index: 1;
  }
  
  /* Tangram parçaları konteynerı */
  #tangram-pieces {
    position: absolute;
    width: 100%;
    height: 100%;
    z-index: 2;
  }
  
  /* Temel parça stili */
  .tangram-piece {
    position: absolute;
    cursor: grab;
    transition: transform 0.1s ease-out;
    z-index: 3;
  }
  
  .tangram-piece.selected {
    box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.5);
    z-index: 4;
  }
  
  .tangram-piece.dragging {
    opacity: 0.8;
    cursor: grabbing;
  }
  
  /* Parça şekilleri */
  .big-triangle-1, .big-triangle-2 {
    width: 0;
    height: 0;
    border-left: 100px solid transparent;
    border-right: 100px solid transparent;
    border-bottom: 141px solid #ff7043; /* Turuncu */
  }
  
  .big-triangle-2 {
    border-bottom-color: #7b1fa2; /* Mor */
  }
  
  .medium-triangle {
    width: 0;
    height: 0;
    border-left: 70px solid transparent;
    border-right: 70px solid transparent;
    border-bottom: 99px solid #4caf50; /* Yeşil */
  }
  
  .small-triangle-1, .small-triangle-2 {
    width: 0;
    height: 0;
    border-left: 50px solid transparent;
    border-right: 50px solid transparent;
    border-bottom: 71px solid #2196f3; /* Mavi */
  }
  
  .small-triangle-2 {
    border-bottom-color: #ffc107; /* Sarı */
  }
  
  .square {
    width: 70px;
    height: 70px;
    background-color: #9c27b0; /* Mor */
  }
  
  .parallelogram {
    width: 80px;
    height: 70px;
    transform: skew(-30deg);
    background-color: #e91e63; /* Pembe */
  }
  
  /* Kontrol paneli stilleri */
  .controls-panel {
    background-color: #f8f9fa;
    border-radius: 8px;
    padding: 15px;
    height: 100%;
  }
  
  /* İstatistik stilleri */
  .stat-label {
    font-size: 0.8rem;
    color: #6c757d;
    margin-bottom: 0.25rem;
  }
  
  .stat-value {
    font-size: 1.1rem;
    font-weight: bold;
    color: #212529;
  }
  
  /* Mobil uyumluluk */
  @media (max-width: 768px) {
    #tangram-board {
      height: 400px;
    }
    
    #target-shape {
      width: 250px;
      height: 250px;
    }
    
    .controls-panel {
      margin-top: 20px;
    }
  }
</style>
{% endblock %}

{% block extra_js %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // DOM elementleri
    const tangramBoard = document.getElementById('tangram-board');
    const targetShape = document.getElementById('target-shape');
    const tangramPieces = document.querySelectorAll('.tangram-piece');
    const levelIndicator = document.getElementById('level-indicator');
    const timerDisplay = document.getElementById('timer');
    const levelSelect = document.getElementById('level-select');
    const loadLevelBtn = document.getElementById('load-level-btn');
    const resetAllBtn = document.getElementById('reset-all-btn');
    const hintBtn = document.getElementById('hint-btn');
    const nextLevelBtn = document.getElementById('next-level-btn');
    const rotateLeftBtn = document.getElementById('rotate-left-btn');
    const rotateRightBtn = document.getElementById('rotate-right-btn');
    const flipBtn = document.getElementById('flip-btn');
    const resetPieceBtn = document.getElementById('reset-piece-btn');
    
    const levelCompleteModal = new bootstrap.Modal(document.getElementById('level-complete-modal'));
    const levelCompleteMessage = document.getElementById('level-complete-message');
    const resultTime = document.getElementById('result-time');
    const resultMoves = document.getElementById('result-moves');
    const nextLevelModalBtn = document.getElementById('next-level-modal');
    
    // Oyun durumu
    let gameState = {
      currentLevel: 1,
      selectedPiece: null,
      moves: 0,
      timer: 0,
      timerInterval: null,
      isComplete: false,
      hint: false
    };
    
    // Tangram seviye tanımları
    const levels = {
      1: {
        name: 'Kare',
        targetShape: 'square',
        pieces: {
          'big-triangle-1': { top: '10%', left: '10%', rotation: 0, flipped: false },
          'big-triangle-2': { top: '10%', left: '50%', rotation: 270, flipped: false },
          'medium-triangle': { top: '50%', left: '50%', rotation: 0, flipped: false },
          'small-triangle-1': { top: '50%', left: '10%', rotation: 0, flipped: false },
          'small-triangle-2': { top: '50%', left: '30%', rotation: 0, flipped: false },
          'square': { top: '30%', left: '30%', rotation: 45, flipped: false },
          'parallelogram': { top: '70%', left: '50%', rotation: 0, flipped: true }
        }
      },
      2: {
        name: 'Ev',
        targetShape: 'house',
        pieces: {
          'big-triangle-1': { top: '30%', left: '20%', rotation: 0, flipped: false },
          'big-triangle-2': { top: '30%', left: '60%', rotation: 0, flipped: false },
          'medium-triangle': { top: '20%', left: '40%', rotation: 180, flipped: false },
          'small-triangle-1': { top: '60%', left: '30%', rotation: 0, flipped: false },
          'small-triangle-2': { top: '60%', left: '50%', rotation: 0, flipped: false },
          'square': { top: '70%', left: '40%', rotation: 0, flipped: false },
          'parallelogram': { top: '40%', left: '40%', rotation: 90, flipped: false }
        }
      },
      3: {
        name: 'Kuş',
        targetShape: 'bird',
        pieces: {
          'big-triangle-1': { top: '20%', left: '30%', rotation: 45, flipped: false },
          'big-triangle-2': { top: '60%', left: '20%', rotation: 0, flipped: false },
          'medium-triangle': { top: '40%', left: '50%', rotation: 270, flipped: false },
          'small-triangle-1': { top: '20%', left: '60%', rotation: 0, flipped: false },
          'small-triangle-2': { top: '40%', left: '70%', rotation: 180, flipped: false },
          'square': { top: '60%', left: '60%', rotation: 45, flipped: false },
          'parallelogram': { top: '30%', left: '50%', rotation: 45, flipped: true }
        }
      },
      4: {
        name: 'Köpek',
        targetShape: 'dog',
        pieces: {
          'big-triangle-1': { top: '40%', left: '30%', rotation: 270, flipped: false },
          'big-triangle-2': { top: '40%', left: '70%', rotation: 315, flipped: false },
          'medium-triangle': { top: '60%', left: '50%', rotation: 0, flipped: false },
          'small-triangle-1': { top: '20%', left: '50%', rotation: 90, flipped: false },
          'small-triangle-2': { top: '30%', left: '60%', rotation: 0, flipped: false },
          'square': { top: '70%', left: '30%', rotation: 0, flipped: false },
          'parallelogram': { top: '70%', left: '70%', rotation: 270, flipped: true }
        }
      },
      5: {
        name: 'Tavşan',
        targetShape: 'rabbit',
        pieces: {
          'big-triangle-1': { top: '60%', left: '40%', rotation: 180, flipped: false },
          'big-triangle-2': { top: '20%', left: '40%', rotation: 225, flipped: false },
          'medium-triangle': { top: '40%', left: '70%', rotation: 0, flipped: false },
          'small-triangle-1': { top: '20%', left: '20%', rotation: 270, flipped: false },
          'small-triangle-2': { top: '40%', left: '20%', rotation: 90, flipped: false },
          'square': { top: '70%', left: '70%', rotation: 45, flipped: false },
          'parallelogram': { top: '50%', left: '30%', rotation: 0, flipped: true }
        }
      }
    };
    
    // Parçaları tahtaya yerleştir
    function placePieces(level) {
      const levelData = levels[level];
      
      tangramPieces.forEach(piece => {
        const pieceType = piece.dataset.shape;
        const pieceData = levelData.pieces[pieceType];
        
        piece.style.top = pieceData.top;
        piece.style.left = pieceData.left;
        
        let transformStyle = `rotate(${pieceData.rotation}deg)`;
        if (pieceData.flipped) {
          transformStyle += ' scaleX(-1)';
        }
        
        piece.style.transform = transformStyle;
        piece.style.opacity = '1';
        
        // Parça verilerini attribute olarak kaydet
        piece.dataset.rotation = pieceData.rotation;
        piece.dataset.flipped = pieceData.flipped;
      });
      
      // Hedef şekli ayarla
      setTargetShape(levelData.targetShape);
    }
    
    // Hedef şekli ayarla
    function setTargetShape(shapeName) {
      // Basit şekiller için CSS background-image kullan
      // Daha karmaşık şekiller için SVG veya Canvas kullanılabilir
      switch (shapeName) {
        case 'square':
          targetShape.style.clipPath = 'polygon(0 0, 100% 0, 100% 100%, 0 100%)';
          break;
        case 'house':
          targetShape.style.clipPath = 'polygon(50% 0, 100% 50%, 100% 100%, 0 100%, 0 50%)';
          break;
        case 'bird':
          targetShape.style.clipPath = 'polygon(20% 20%, 40% 0, 60% 20%, 80% 0, 100% 20%, 80% 40%, 100% 60%, 80% 80%, 60% 60%, 40% 80%, 20% 60%, 0 80%, 20% 40%, 0 20%)';
          break;
        case 'dog':
          targetShape.style.clipPath = 'polygon(20% 0, 60% 0, 80% 20%, 100% 20%, 100% 60%, 80% 80%, 60% 80%, 40% 100%, 20% 100%, 0 80%, 0 40%, 20% 20%)';
          break;
        case 'rabbit':
          targetShape.style.clipPath = 'polygon(20% 0, 40% 0, 60% 20%, 80% 0, 100% 20%, 100% 60%, 80% 80%, 60% 100%, 40% 100%, 20% 80%, 0 60%, 0 20%)';
          break;
        default:
          targetShape.style.clipPath = 'none';
      }
    }
    
    // Seviyeyi yükle
    function loadLevel(level) {
      // Mevcut oyun durumunu sıfırla
      gameState.currentLevel = level;
      gameState.moves = 0;
      gameState.isComplete = false;
      
      // Parçaları yerleştir
      placePieces(level);
      
      // Seçili parçayı temizle
      if (gameState.selectedPiece) {
        gameState.selectedPiece.classList.remove('selected');
        gameState.selectedPiece = null;
      }
      
      // Seviye göstergesini güncelle
      levelIndicator.textContent = `Seviye ${level}`;
      
      // İpucu modunu kapat
      gameState.hint = false;
      tangramPieces.forEach(piece => {
        piece.style.opacity = '1';
      });
      
      // Zamanlayıcıyı sıfırla ve başlat
      clearInterval(gameState.timerInterval);
      gameState.timer = 0;
      updateTimerDisplay();
      gameState.timerInterval = setInterval(() => {
        gameState.timer++;
        updateTimerDisplay();
      }, 1000);
    }
    
    // Zamanlayıcıyı güncelle
    function updateTimerDisplay() {
      const minutes = Math.floor(gameState.timer / 60);
      const seconds = gameState.timer % 60;
      timerDisplay.innerHTML = `<i class="fas fa-clock me-1"></i>${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }
    
    // Zamanı formatla
    function formatTime(seconds) {
      const minutes = Math.floor(seconds / 60);
      seconds = seconds % 60;
      return `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }
    
    // İpucu göster/gizle
    function toggleHint() {
      gameState.hint = !gameState.hint;
      
      if (gameState.hint) {
        // İpucu modundayken parçalar yarı saydam
        tangramPieces.forEach(piece => {
          piece.style.opacity = '0.5';
        });
        
        // 3 saniye sonra ipucu modunu kapat
        setTimeout(() => {
          gameState.hint = false;
          tangramPieces.forEach(piece => {
            piece.style.opacity = '1';
          });
        }, 3000);
      } else {
        // İpucu modundan çıkınca parçalar tam opak
        tangramPieces.forEach(piece => {
          piece.style.opacity = '1';
        });
      }
    }
    
    // Seviye tamamlandı
    function levelComplete() {
      // Zamanlayıcıyı durdur
      clearInterval(gameState.timerInterval);
      
      // Seviyeyi tamamlandı olarak işaretle
      gameState.isComplete = true;
      
      // Modal içeriğini hazırla
      levelCompleteMessage.textContent = `Seviye ${gameState.currentLevel}'i başarıyla tamamladınız!`;
      resultTime.textContent = formatTime(gameState.timer);
      resultMoves.textContent = gameState.moves;
      
      // Modalı göster
      levelCompleteModal.show();
    }
    
    // Sonraki seviyeye geç
    function nextLevel() {
      const nextLevel = (gameState.currentLevel % 5) + 1;
      loadLevel(nextLevel);
    }
    
    // Event Listeners
    
    // Parça seçme
    tangramPieces.forEach(piece => {
      piece.addEventListener('mousedown', function(e) {
        // Sağ tıklamaları engelle
        if (e.button === 2) return;
        
        // Seviye tamamlandıysa işlemi engelle
        if (gameState.isComplete) return;
        
        // Önceki seçili parçayı temizle
        if (gameState.selectedPiece) {
          gameState.selectedPiece.classList.remove('selected');
        }
        
        // Yeni parçayı seç
        gameState.selectedPiece = this;
        this.classList.add('selected');
        
        // Sürükleme için hazırla
        this.classList.add('dragging');
        
        // Hamle sayısını artır
        gameState.moves++;
        
        e.preventDefault();
      });
    });
    
    // Parça sürükleme
    document.addEventListener('mousemove', function(e) {
      if (!gameState.selectedPiece || !gameState.selectedPiece.classList.contains('dragging')) return;
      
      const piece = gameState.selectedPiece;
      const board = tangramBoard.getBoundingClientRect();
      
      // Parçanın yeni konumunu hesapla
      let left = ((e.clientX - board.left) / board.width) * 100;
      let top = ((e.clientY - board.top) / board.height) * 100;
      
      // Sınırlar dahilinde tut
      left = Math.max(0, Math.min(left, 100));
      top = Math.max(0, Math.min(top, 100));
      
      // Parçayı taşı
      piece.style.left = `${left}%`;
      piece.style.top = `${top}%`;
    });
    
    // Sürüklemeyi bitir
    document.addEventListener('mouseup', function() {
      tangramPieces.forEach(piece => {
        piece.classList.remove('dragging');
      });
    });
    
    // Kontrol butonları
    rotateLeftBtn.addEventListener('click', function() {
      if (!gameState.selectedPiece) return;
      
      const piece = gameState.selectedPiece;
      const currentRotation = parseInt(piece.dataset.rotation || 0);
      const newRotation = (currentRotation - 45) % 360;
      
      piece.dataset.rotation = newRotation;
      
      // Transform stilini güncelle
      let transform = `rotate(${newRotation}deg)`;
      if (piece.dataset.flipped === 'true') {
        transform += ' scaleX(-1)';
      }
      
      piece.style.transform = transform;
      
      // Hamle sayısını artır
      gameState.moves++;
    });
    
    rotateRightBtn.addEventListener('click', function() {
      if (!gameState.selectedPiece) return;
      
      const piece = gameState.selectedPiece;
      const currentRotation = parseInt(piece.dataset.rotation || 0);
      const newRotation = (currentRotation + 45) % 360;
      
      piece.dataset.rotation = newRotation;
      
      // Transform stilini güncelle
      let transform = `rotate(${newRotation}deg)`;
      if (piece.dataset.flipped === 'true') {
        transform += ' scaleX(-1)';
      }
      
      piece.style.transform = transform;
      
      // Hamle sayısını artır
      gameState.moves++;
    });
    
    flipBtn.addEventListener('click', function() {
      if (!gameState.selectedPiece) return;
      
      const piece = gameState.selectedPiece;
      const isFlipped = piece.dataset.flipped === 'true';
      
      piece.dataset.flipped = !isFlipped;
      
      // Transform stilini güncelle
      let transform = `rotate(${piece.dataset.rotation || 0}deg)`;
      if (!isFlipped) {
        transform += ' scaleX(-1)';
      }
      
      piece.style.transform = transform;
      
      // Hamle sayısını artır
      gameState.moves++;
    });
    
    resetPieceBtn.addEventListener('click', function() {
      if (!gameState.selectedPiece) return;
      
      const piece = gameState.selectedPiece;
      const pieceType = piece.dataset.shape;
      const pieceData = levels[gameState.currentLevel].pieces[pieceType];
      
      piece.style.top = pieceData.top;
      piece.style.left = pieceData.left;
      
      let transformStyle = `rotate(${pieceData.rotation}deg)`;
      if (pieceData.flipped) {
        transformStyle += ' scaleX(-1)';
      }
      
      piece.style.transform = transformStyle;
      
      piece.dataset.rotation = pieceData.rotation;
      piece.dataset.flipped = pieceData.flipped;
      
      // Hamle sayısını artır
      gameState.moves++;
    });
    
    // Seviye kontrolleri
    levelSelect.addEventListener('change', function() {
      // İleri kullanım için seçilen seviyeyi kaydet
      gameState.selectedLevel = parseInt(this.value);
    });
    
    loadLevelBtn.addEventListener('click', function() {
      const level = parseInt(levelSelect.value);
      loadLevel(level);
    });
    
    resetAllBtn.addEventListener('click', function() {
      loadLevel(gameState.currentLevel);
    });
    
    hintBtn.addEventListener('click', toggleHint);
    
    nextLevelBtn.addEventListener('click', nextLevel);
    nextLevelModalBtn.addEventListener('click', function() {
      levelCompleteModal.hide();
      nextLevel();
    });
    
    // Her 100ms'de bir seviyenin tamamlandığını kontrol et
    // Bu basit bir kontrol mekanizması, gerçek bir oyun için
    // daha karmaşık ve doğru bir doğrulama algoritması gerekir
    const checkIntervalId = setInterval(() => {
      if (gameState.isComplete) return;
      
      // Seviyenin tamamlandığını varsay (demo amaçlı)
      // Gerçek bir oyunda, parçaların doğru pozisyonda olup olmadığını kontrol etmemiz gerekir
      const randomChance = Math.random() * 100;
      if (randomChance < 0.1 && gameState.timer > 5) {
        levelComplete();
      }
    }, 100);
    
    // İlk seviyeyi yükle
    loadLevel(1);
  });
</script>
{% endblock %}