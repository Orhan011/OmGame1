{% extends 'layout.html' %}

{% block title %}Yazma Hızı Testi - ZekaPark{% endblock %}

{% block content %}
<div class="page-container">
  <div class="game-container">
    <div class="game-header">
      <h1>Yazma Hızı <span class="badge">Klavye Hız Testi</span></h1>
      <p class="game-description">Belirli metinleri hızlı ve doğru bir şekilde yazarak yazma becerilerinizi geliştirin.</p>
    </div>

    <div class="typing-container">
      <div class="typing-test-wrapper">
        <div class="typing-header">
          <div class="typing-stats">
            <div class="stat-item">
              <div class="stat-label">Süre</div>
              <div class="stat-value" id="timer">60</div>
              <div class="progress-bar-mini">
                <div class="progress-fill" id="timer-fill"></div>
              </div>
            </div>
            <div class="stat-item">
              <div class="stat-label">Kelime/Dk</div>
              <div class="stat-value" id="wpm">0</div>
            </div>
            <div class="stat-item">
              <div class="stat-label">Doğruluk</div>
              <div class="stat-value" id="accuracy">100%</div>
            </div>
            <div class="stat-item">
              <div class="stat-label">Hatalar</div>
              <div class="stat-value" id="errors">0</div>
            </div>
          </div>

          <div class="typing-mode">
            <button id="mode-words" class="mode-button active">Kelime Modu</button>
            <button id="mode-time" class="mode-button">Zaman Modu</button>
          </div>
        </div>

        <div class="typing-content">
          <div id="test-intro" class="test-intro active">
            <h3>Yazma Hız Testine Hoş Geldiniz</h3>
            <p>Bu test yazma hızınızı ve doğruluğunuzu ölçmek için tasarlanmıştır.</p>
            
            <div class="test-options">
              <div class="option-row">
                <div class="option-section">
                  <h4>Mod Seçin:</h4>
                  <div class="radio-group">
                    <div class="radio-option">
                      <label class="radio-label">
                        <input type="radio" id="words-mode" name="test-mode" value="words" checked>
                        <span class="radio-mark"></span>
                        <div class="radio-content">
                          <span class="radio-title">Kelime Modu</span>
                          <span class="radio-description">Belirli sayıda kelimeyi tamamlayarak hızınızı ölçün</span>
                        </div>
                      </label>
                    </div>
                    <div class="radio-option">
                      <label class="radio-label">
                        <input type="radio" id="time-mode" name="test-mode" value="time">
                        <span class="radio-mark"></span>
                        <div class="radio-content">
                          <span class="radio-title">Zaman Modu</span>
                          <span class="radio-description">Belirli bir süre içinde yazarak hızınızı ölçün</span>
                        </div>
                      </label>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="option-row">
                <div class="option-section" id="words-option">
                  <h4>Kelime Sayısı:</h4>
                  <div class="button-group">
                    <button class="option-button" data-words="10">10</button>
                    <button class="option-button active" data-words="25">25</button>
                    <button class="option-button" data-words="50">50</button>
                    <button class="option-button" data-words="100">100</button>
                  </div>
                </div>
                
                <div class="option-section" id="time-option" style="display: none;">
                  <h4>Süre (saniye):</h4>
                  <div class="button-group">
                    <button class="option-button" data-time="30">30</button>
                    <button class="option-button active" data-time="60">60</button>
                    <button class="option-button" data-time="120">120</button>
                    <button class="option-button" data-time="300">300</button>
                  </div>
                </div>
              </div>
              
              <div class="option-section">
                <h4>Zorluk Seviyesi:</h4>
                <div class="button-group difficulty-group">
                  <button class="difficulty-button active" data-difficulty="easy">
                    <span class="difficulty-icon">
                      <i class="fas fa-walking"></i>
                    </span>
                    <span class="difficulty-content">
                      <span class="difficulty-title">Kolay</span>
                      <span class="difficulty-description">Kısa ve basit kelimeler</span>
                    </span>
                  </button>
                  <button class="difficulty-button" data-difficulty="medium">
                    <span class="difficulty-icon">
                      <i class="fas fa-running"></i>
                    </span>
                    <span class="difficulty-content">
                      <span class="difficulty-title">Orta</span>
                      <span class="difficulty-description">Orta zorlukta kelimeler</span>
                    </span>
                  </button>
                  <button class="difficulty-button" data-difficulty="hard">
                    <span class="difficulty-icon">
                      <i class="fas fa-biking"></i>
                    </span>
                    <span class="difficulty-content">
                      <span class="difficulty-title">Zor</span>
                      <span class="difficulty-description">Uzun ve karmaşık kelimeler</span>
                    </span>
                  </button>
                </div>
              </div>
            </div>
            
            <button id="start-test" class="btn btn-primary btn-lg">
              <i class="fas fa-keyboard me-2"></i>Teste Başla
            </button>
          </div>

          <div id="typing-text-area" class="typing-text-area" style="display: none;">
            <div class="typing-text" id="typing-text"></div>
            <div class="text-cursor-box">
              <input type="text" id="input-field" class="input-field" placeholder="Yazmaya başlamak için buraya tıklayın..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
              <span class="focus-reminder" id="focus-reminder">Yazmak için tıklayın</span>
            </div>
          </div>
        </div>

        <div class="typing-controls">
          <button id="restart-test" class="btn btn-outline-warning">
            <i class="fas fa-redo-alt me-2"></i>Yeniden Başlat
          </button>
          <a href="{{ url_for('all_games') }}" class="btn btn-outline-secondary">
            <i class="fas fa-th-large me-2"></i>Tüm Oyunlar
          </a>
        </div>
      </div>

      <div id="results-screen" class="typing-results" style="display: none;">
        <h2><i class="fas fa-chart-line me-2"></i>Test Sonuçları</h2>

        <div class="results-summary">
          <div class="results-item result-main">
            <div class="result-value" id="result-wpm">0</div>
            <div class="result-label">Kelime/Dakika (WPM)</div>
          </div>
          <div class="results-item result-main">
            <div class="result-value" id="result-accuracy">100%</div>
            <div class="result-label">Doğruluk</div>
          </div>
        </div>

        <div class="results-details">
          <div class="results-row">
            <div class="results-column">
              <div class="results-item">
                <div class="result-label">Karakterler</div>
                <div class="result-value" id="result-characters">0</div>
              </div>
              <div class="results-item">
                <div class="result-label">Doğru Vuruşlar</div>
                <div class="result-value" id="result-correct-chars">0</div>
              </div>
            </div>
            <div class="results-column">
              <div class="results-item">
                <div class="result-label">Doğru Kelimeler</div>
                <div class="result-value" id="result-correct-words">0</div>
              </div>
              <div class="results-item">
                <div class="result-label">Hatalar</div>
                <div class="result-value" id="result-errors">0</div>
              </div>
            </div>
            <div class="results-column">
              <div class="results-item">
                <div class="result-label">Yanlış Kelimeler</div>
                <div class="result-value" id="result-wrong-words">0</div>
              </div>
              <div class="results-item">
                <div class="result-label">Kullandığınız Süre</div>
                <div class="result-value" id="result-time-used">0</div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="typing-performance">
          <h3>Performans Değerlendirmesi</h3>
          <div class="performance-meter">
            <div class="performance-bar-container">
              <div class="performance-bar" id="performance-bar"></div>
            </div>
            <div class="performance-labels">
              <span>Başlangıç</span>
              <span>Orta</span>
              <span>İyi</span>
              <span>Çok İyi</span>
              <span>Mükemmel</span>
            </div>
          </div>
          <p id="performance-message">Tebrikler! İyi bir performans gösterdiniz.</p>
        </div>

        <div class="results-actions">
          <button id="retry-test" class="btn btn-primary btn-lg">
            <i class="fas fa-redo-alt me-2"></i>Tekrar Dene
          </button>
          <a href="{{ url_for('all_games') }}" class="btn btn-outline-light btn-lg">
            <i class="fas fa-th-large me-2"></i>Tüm Oyunlar
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .typing-container {
    max-width: 100%;
    margin: 0 auto;
    padding: 0 10px;
  }

  .typing-test-wrapper {
    background: rgba(25, 25, 45, 0.8);
    border-radius: 16px;
    padding: 25px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.05);
    transition: all 0.3s ease;
  }
  
  .typing-test-wrapper:hover {
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.35);
    border-color: rgba(106, 90, 224, 0.2);
  }

  .typing-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
    flex-wrap: wrap;
    gap: 15px;
  }

  .typing-stats {
    display: flex;
    background: rgba(30, 30, 60, 0.6);
    border-radius: 12px;
    overflow: hidden;
    flex-wrap: wrap;
    width: 100%;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.05);
  }

  .stat-item {
    padding: 15px;
    text-align: center;
    border-right: 1px solid rgba(255, 255, 255, 0.05);
    flex-grow: 1;
    flex-basis: 0;
    min-width: 80px;
    position: relative;
  }

  .stat-item:last-child {
    border-right: none;
  }

  .stat-label {
    font-size: 0.85rem;
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: 5px;
  }

  .stat-value {
    font-size: 1.4rem;
    font-weight: 700;
    color: #fff;
    transition: all 0.3s ease;
  }
  
  .progress-bar-mini {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 3px;
    background: rgba(255, 255, 255, 0.1);
  }
  
  .progress-fill {
    height: 100%;
    width: 100%;
    background: linear-gradient(to right, #6a5ae0, #a890ff);
    transition: width 1s linear;
  }

  #wpm, #result-wpm {
    color: var(--accent-color);
    text-shadow: 0 0 10px rgba(106, 90, 224, 0.3);
  }

  #errors, #result-errors {
    color: #ff4757;
  }

  .typing-mode {
    display: flex;
    overflow: hidden;
    border-radius: 30px;
    width: 100%;
    margin-top: 10px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.05);
  }

  .mode-button {
    padding: 10px 15px;
    background: rgba(30, 30, 60, 0.6);
    border: none;
    color: #fff;
    cursor: pointer;
    transition: all 0.3s ease;
    flex-grow: 1;
    text-align: center;
    font-weight: 500;
  }

  .mode-button.active {
    background: linear-gradient(90deg, #6a5ae0, #a890ff);
    box-shadow: 0 5px 15px rgba(106, 90, 224, 0.3);
  }

  .mode-button:first-child {
    border-top-left-radius: 30px;
    border-bottom-left-radius: 30px;
  }

  .mode-button:last-child {
    border-top-right-radius: 30px;
    border-bottom-right-radius: 30px;
  }

  .typing-content {
    position: relative;
    margin-bottom: 25px;
  }

  .test-intro {
    display: none;
    text-align: center;
    padding: 20px 15px;
    animation: fadeIn 0.5s ease;
  }

  .test-intro.active {
    display: block;
  }

  .test-intro h3 {
    color: var(--accent-color);
    margin-bottom: 15px;
    font-weight: 700;
    font-size: 1.8rem;
    background: linear-gradient(90deg, #6a5ae0, #a890ff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    display: inline-block;
  }

  .test-intro p {
    color: rgba(255, 255, 255, 0.9);
    margin-bottom: 25px;
    font-size: 1.1rem;
    line-height: 1.6;
    max-width: 700px;
    margin-left: auto;
    margin-right: auto;
  }

  .test-options {
    margin-bottom: 30px;
  }
  
  .option-row {
    display: flex;
    gap: 15px;
    margin-bottom: 15px;
  }
  
  @media (max-width: 768px) {
    .option-row {
      flex-direction: column;
    }
  }

  .option-section {
    background: rgba(35, 35, 65, 0.6);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 15px;
    text-align: left;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.05);
    flex: 1;
    transition: all 0.3s ease;
  }
  
  .option-section:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
    border-color: rgba(106, 90, 224, 0.15);
  }

  .option-section h4 {
    font-size: 1.1rem;
    color: #fff;
    margin-bottom: 15px;
    position: relative;
    display: inline-block;
    padding-bottom: 8px;
  }
  
  .option-section h4:after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 40px;
    height: 2px;
    background: var(--accent-color);
    border-radius: 2px;
  }

  .button-group {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }

  .option-button, .difficulty-button {
    padding: 10px 15px;
    background: rgba(40, 40, 80, 0.6);
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    color: white;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.95rem;
    font-weight: 500;
  }

  .option-button:hover, .difficulty-button:hover {
    background: rgba(60, 60, 100, 0.6);
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  }

  .option-button.active, .difficulty-button.active {
    background: rgba(106, 90, 224, 0.5);
    border-color: rgba(106, 90, 224, 0.8);
    box-shadow: 0 5px 15px rgba(106, 90, 224, 0.2);
  }
  
  .difficulty-group {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  
  .difficulty-button {
    display: flex;
    align-items: center;
    gap: 12px;
    text-align: left;
    padding: 12px 15px;
  }
  
  .difficulty-icon {
    width: 35px;
    height: 35px;
    background: rgba(106, 90, 224, 0.2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    color: var(--accent-color);
    transition: all 0.3s ease;
  }
  
  .difficulty-button:hover .difficulty-icon {
    background: rgba(106, 90, 224, 0.4);
    transform: scale(1.1);
  }
  
  .difficulty-button.active .difficulty-icon {
    background: rgba(106, 90, 224, 0.6);
  }
  
  .difficulty-content {
    display: flex;
    flex-direction: column;
  }
  
  .difficulty-title {
    font-weight: 600;
    font-size: 1rem;
    margin-bottom: 3px;
  }
  
  .difficulty-description {
    font-size: 0.85rem;
    color: rgba(255, 255, 255, 0.7);
  }

  .radio-group {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }

  .radio-option {
    margin-bottom: 5px;
  }

  .radio-label {
    display: flex;
    align-items: flex-start;
    cursor: pointer;
    position: relative;
    padding: 15px;
    background: rgba(40, 40, 80, 0.6);
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    transition: all 0.3s ease;
  }
  
  .radio-label:hover {
    background: rgba(60, 60, 100, 0.6);
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  }

  .radio-label input {
    position: absolute;
    opacity: 0;
  }

  .radio-mark {
    width: 22px;
    height: 22px;
    border-radius: 50%;
    border: 2px solid rgba(255, 255, 255, 0.3);
    display: inline-block;
    position: relative;
    margin-right: 15px;
    margin-top: 2px;
    flex-shrink: 0;
    transition: all 0.3s ease;
  }

  .radio-mark:after {
    content: "";
    position: absolute;
    display: none;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: var(--accent-color);
  }

  .radio-label input:checked ~ .radio-mark {
    border-color: var(--accent-color);
  }

  .radio-label input:checked ~ .radio-mark:after {
    display: block;
  }
  
  .radio-label input:checked ~ .radio-content .radio-title {
    color: var(--accent-color);
  }
  
  .radio-content {
    display: flex;
    flex-direction: column;
  }
  
  .radio-title {
    font-weight: 600;
    font-size: 1.05rem;
    margin-bottom: 5px;
    transition: all 0.3s ease;
  }
  
  .radio-description {
    font-size: 0.9rem;
    color: rgba(255, 255, 255, 0.7);
    line-height: 1.4;
  }

  #start-test {
    font-size: 1.1rem;
    font-weight: 600;
    border-radius: 30px;
    background: linear-gradient(90deg, #6a5ae0, #a890ff);
    border: none;
    box-shadow: 0 5px 15px rgba(106, 90, 224, 0.4);
    transition: all 0.3s ease;
    padding: 12px 30px;
  }
  
  #start-test:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(106, 90, 224, 0.6);
  }

  .typing-text-area {
    margin-bottom: 20px;
    animation: fadeIn 0.5s ease;
  }

  .typing-text {
    background: rgba(35, 35, 65, 0.6);
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 20px;
    font-size: 1.2rem;
    line-height: 1.8;
    min-height: 150px;
    margin-bottom: 15px;
    color: rgba(255, 255, 255, 0.7);
    user-select: none;
    overflow-wrap: break-word;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  }
  
  .text-cursor-box {
    position: relative;
  }

  .input-field {
    width: 100%;
    padding: 15px;
    background: rgba(40, 40, 80, 0.6);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    color: #fff;
    font-size: 1.1rem;
    transition: all 0.3s ease;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  }

  .input-field:focus {
    outline: none;
    border-color: var(--accent-color);
    box-shadow: 0 5px 20px rgba(106, 90, 224, 0.3);
    background: rgba(50, 50, 90, 0.6);
  }
  
  .focus-reminder {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: rgba(255, 255, 255, 0.5);
    pointer-events: none;
    transition: all 0.3s ease;
    opacity: 0;
    font-size: 0.9rem;
  }
  
  .input-field:not(:focus) + .focus-reminder {
    opacity: 1;
  }

  .typing-controls {
    display: flex;
    justify-content: center;
    gap: 15px;
  }
  
  .typing-controls button,
  .typing-controls a {
    padding: 10px 20px;
    border-radius: 30px;
    font-weight: 500;
    transition: all 0.3s ease;
  }
  
  .typing-controls button:hover,
  .typing-controls a:hover {
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  }

  /* Text Character Styling */
  .char {
    display: inline-block;
    position: relative;
    transition: all 0.1s ease;
  }

  .correct {
    color: #6ab04c;
  }

  .incorrect {
    color: #ff4757;
    text-decoration: underline;
    text-decoration-color: #ff4757;
    text-decoration-thickness: 2px;
  }

  .active {
    background-color: rgba(106, 90, 224, 0.2);
    border-radius: 2px;
    animation: cursor-blink 1s infinite;
  }
  
  @keyframes cursor-blink {
    0%, 100% { background-color: rgba(106, 90, 224, 0.2); }
    50% { background-color: rgba(106, 90, 224, 0.5); }
  }

  /* Results Screen */
  .typing-results {
    background: rgba(25, 25, 45, 0.8);
    border-radius: 16px;
    padding: 30px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.05);
    text-align: center;
    animation: fadeIn 0.5s ease;
  }

  .typing-results h2 {
    color: var(--accent-color);
    margin-bottom: 25px;
    font-size: 2rem;
    font-weight: 700;
    background: linear-gradient(90deg, #6a5ae0, #a890ff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    display: inline-block;
  }

  .results-summary {
    display: flex;
    justify-content: center;
    gap: 25px;
    margin-bottom: 30px;
    flex-wrap: wrap;
  }

  .result-main {
    background: rgba(40, 40, 80, 0.6);
    border-radius: 16px;
    padding: 25px;
    min-width: 180px;
    flex-grow: 1;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    border: 1px solid rgba(255, 255, 255, 0.05);
    transition: all 0.3s ease;
    max-width: 250px;
  }
  
  .result-main:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 25px rgba(0, 0, 0, 0.2);
    border-color: rgba(106, 90, 224, 0.2);
  }

  .result-main .result-value {
    font-size: 3.5rem;
    font-weight: 800;
    margin-bottom: 10px;
    background: linear-gradient(90deg, #6a5ae0, #a890ff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    line-height: 1;
  }

  .result-main .result-label {
    font-size: 1.1rem;
    color: rgba(255, 255, 255, 0.8);
  }

  .results-details {
    background: rgba(35, 35, 65, 0.6);
    border-radius: 16px;
    padding: 25px;
    margin-bottom: 30px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    border: 1px solid rgba(255, 255, 255, 0.05);
  }
  
  .results-row {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: space-between;
  }

  .results-column {
    flex: 1;
    min-width: 200px;
  }

  .results-item {
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  }

  .results-column .results-item:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
    border-bottom: none;
  }

  .results-item .result-label {
    font-size: 0.9rem;
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: 8px;
  }

  .results-item .result-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: #fff;
  }
  
  .typing-performance {
    background: rgba(35, 35, 65, 0.6);
    border-radius: 16px;
    padding: 25px;
    margin-bottom: 30px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    border: 1px solid rgba(255, 255, 255, 0.05);
    text-align: center;
  }
  
  .typing-performance h3 {
    font-size: 1.3rem;
    color: #fff;
    margin-bottom: 20px;
    position: relative;
    display: inline-block;
    padding-bottom: 8px;
  }
  
  .typing-performance h3:after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background: var(--accent-color);
    border-radius: 2px;
  }
  
  .performance-meter {
    margin-bottom: 20px;
  }
  
  .performance-bar-container {
    height: 10px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 5px;
    overflow: hidden;
    margin-bottom: 8px;
  }
  
  .performance-bar {
    height: 100%;
    background: linear-gradient(to right, #ff7675, #6a5ae0, #00cec9, #55efc4, #00b894);
    width: 0;
    transition: width 1.5s ease-out;
    border-radius: 5px;
  }
  
  .performance-labels {
    display: flex;
    justify-content: space-between;
    font-size: 0.8rem;
    color: rgba(255, 255, 255, 0.7);
  }
  
  #performance-message {
    font-size: 1.1rem;
    color: rgba(255, 255, 255, 0.9);
    margin-top: 15px;
    font-weight: 500;
  }

  .results-actions {
    display: flex;
    justify-content: center;
    gap: 15px;
    flex-wrap: wrap;
  }
  
  .results-actions button,
  .results-actions a {
    padding: 12px 25px;
    border-radius: 30px;
    font-weight: 600;
    transition: all 0.3s ease;
  }
  
  .results-actions button:hover,
  .results-actions a:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
  }
  
  /* Animations */
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  @keyframes slideInUp {
    from { 
      transform: translateY(20px);
      opacity: 0;
    }
    to { 
      transform: translateY(0);
      opacity: 1;
    }
  }
  
  @keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
  }
  
  @keyframes highlightChar {
    0% { background-color: rgba(106, 90, 224, 0.3); }
    100% { background-color: transparent; }
  }
  
  /* Visual feedback for correct/incorrect typing */
  .char.correct {
    color: #6ab04c;
    animation: highlightChar 0.3s ease-out;
  }
  
  .char.incorrect {
    color: #ff4757;
    text-decoration: underline;
    animation: shake 0.3s ease-in-out;
  }
  
  @keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-2px); }
    75% { transform: translateX(2px); }
  }
  
  /* Results animations */
  .results-summary, .results-details, .results-actions, .typing-performance {
    animation: slideInUp 0.6s ease-out;
    animation-fill-mode: both;
  }
  
  .results-details {
    animation-delay: 0.1s;
  }
  
  .typing-performance {
    animation-delay: 0.2s;
  }
  
  .results-actions {
    animation-delay: 0.3s;
  }
  
  /* Button effect */
  .btn {
    position: relative;
    overflow: hidden;
  }
  
  .btn:after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 5px;
    height: 5px;
    background: rgba(255, 255, 255, 0.5);
    opacity: 0;
    border-radius: 100%;
    transform: scale(1, 1) translate(-50%);
    transform-origin: 50% 50%;
  }
  
  .btn:focus:not(:active)::after {
    animation: ripple 1s ease-out;
  }
  
  @keyframes ripple {
    0% {
      transform: scale(0, 0);
      opacity: 0.5;
    }
    20% {
      transform: scale(25, 25);
      opacity: 0.3;
    }
    100% {
      opacity: 0;
      transform: scale(40, 40);
    }
  }
  
  /* Mobil Optimizasyonlar */
  @media (max-width: 768px) {
    .typing-test-wrapper, .typing-results {
      padding: 20px;
    }
    
    .typing-header {
      flex-direction: column;
      margin-bottom: 20px;
    }
    
    .typing-stats {
      flex-wrap: wrap;
    }
    
    .stat-item {
      flex: 1 0 40%;
      padding: 10px;
    }
    
    .stat-value {
      font-size: 1.2rem;
    }
    
    .test-intro h3 {
      font-size: 1.5rem;
    }
    
    .test-intro p {
      font-size: 1rem;
    }
    
    .typing-text {
      font-size: 1rem;
      padding: 15px;
      line-height: 1.6;
    }
    
    .input-field {
      padding: 12px;
      font-size: 1rem;
    }
    
    .results-summary {
      flex-direction: column;
      align-items: center;
      gap: 15px;
    }
    
    .result-main {
      max-width: 100%;
      width: 100%;
      padding: 20px;
    }
    
    .result-main .result-value {
      font-size: 2.8rem;
    }
    
    .results-row {
      flex-direction: column;
      gap: 0;
    }
    
    .results-column {
      width: 100%;
    }
    
    .results-actions {
      flex-direction: column;
    }
    
    .results-actions button,
    .results-actions a {
      width: 100%;
    }
    
    .typing-performance h3 {
      font-size: 1.2rem;
    }
    
    #performance-message {
      font-size: 1rem;
    }
    
    .difficulty-button {
      flex-direction: column;
      align-items: center;
      text-align: center;
      padding: 15px 10px;
    }
    
    .difficulty-icon {
      margin-bottom: 10px;
    }
  }
  
  /* Küçük ekranlar için ek optimizasyonlar */
  @media (max-width: 480px) {
    .typing-test-wrapper, .typing-results {
      padding: 15px;
    }
    
    .stat-item {
      flex: 1 0 50%;
    }
    
    .typing-text {
      min-height: 120px;
      font-size: 0.95rem;
    }
    
    .result-main .result-value {
      font-size: 2.5rem;
    }
    
    .results-item .result-value {
      font-size: 1.3rem;
    }
    
    .option-button {
      padding: 8px 10px;
      font-size: 0.85rem;
    }
    
    .button-group {
      justify-content: center;
    }
  }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // DOM Elements
  const testIntro = document.getElementById('test-intro');
  const typingTextArea = document.getElementById('typing-text-area');
  const resultsScreen = document.getElementById('results-screen');
  
  const typingText = document.getElementById('typing-text');
  const inputField = document.getElementById('input-field');
  const timer = document.getElementById('timer');
  const timerFill = document.getElementById('timer-fill');
  const wpmDisplay = document.getElementById('wpm');
  const accuracyDisplay = document.getElementById('accuracy');
  const errorsDisplay = document.getElementById('errors');
  const focusReminder = document.getElementById('focus-reminder');
  
  const modeWordsBtn = document.getElementById('mode-words');
  const modeTimeBtn = document.getElementById('mode-time');
  const wordsModeRadio = document.getElementById('words-mode');
  const timeModeRadio = document.getElementById('time-mode');
  const wordsOption = document.getElementById('words-option');
  const timeOption = document.getElementById('time-option');
  
  const startTestBtn = document.getElementById('start-test');
  const restartTestBtn = document.getElementById('restart-test');
  const retryTestBtn = document.getElementById('retry-test');
  
  // Results elements
  const resultWpm = document.getElementById('result-wpm');
  const resultAccuracy = document.getElementById('result-accuracy');
  const resultCharacters = document.getElementById('result-characters');
  const resultCorrectChars = document.getElementById('result-correct-chars');
  const resultCorrectWords = document.getElementById('result-correct-words');
  const resultErrors = document.getElementById('result-errors');
  const resultWrongWords = document.getElementById('result-wrong-words');
  const resultTimeUsed = document.getElementById('result-time-used');
  const performanceBar = document.getElementById('performance-bar');
  const performanceMessage = document.getElementById('performance-message');
  
  // Test settings
  let testSettings = {
    mode: 'words',   // 'words' or 'time'
    wordCount: 25,   // Number of words for words mode
    timeLimit: 60,   // Time limit in seconds for time mode
    difficulty: 'easy' // 'easy', 'medium', or 'hard'
  };
  
  // Test state
  let testState = {
    started: false,
    completed: false,
    timeLeft: testSettings.timeLimit,
    totalTime: 0,
    timerInterval: null,
    words: [],
    currentWordIndex: 0,
    currentCharIndex: 0,
    correctChars: 0,
    incorrectChars: 0,
    correctWords: 0,
    incorrectWords: 0,
    startTime: 0,
    wpm: 0
  };
  
  // Word lists by difficulty
  const wordLists = {
    easy: [
      "ve", "bu", "bir", "için", "o", "ben", "ile", "de", "da", "ki",
      "ne", "var", "yok", "çok", "ama", "her", "daha", "kadar", "sonra", "gibi",
      "en", "hiç", "ya", "biz", "mi", "siz", "evet", "hayır", "şey", "iyi",
      "kötü", "güzel", "büyük", "küçük", "uzun", "kısa", "yeni", "eski", "sıcak", "soğuk",
      "gün", "ay", "yıl", "zaman", "su", "hava", "yer", "göz", "el", "baş"
    ],
    medium: [
      "zaman", "insan", "dünya", "hayat", "bilgi", "sistem", "durum", "yüzde", "çalışma", "konu",
      "örnek", "gelişme", "sorun", "amaç", "dönem", "süreç", "toplum", "sonuç", "hizmet", "değer",
      "kaynak", "özellik", "yönetim", "başarı", "ilişki", "kullanım", "güvenlik", "destek", "üretim", "kontrol",
      "ekonomi", "teknoloji", "sağlık", "eğitim", "gelecek", "geçmiş", "bugün", "yarın", "hafta", "ay",
      "kitap", "müzik", "film", "sanat", "spor", "oyun", "haber", "para", "fiyat", "pazar"
    ],
    hard: [
      "sürdürülebilirlik", "küreselleşme", "demokratikleşme", "entegrasyon", "optimizasyon", "standardizasyon", "senkronizasyon", "transformasyon", "konsolidasyon", "modernizasyon",
      "sosyalleşme", "bireyselleşme", "profesyonelleşme", "dijitalleşme", "endüstrileşme", "kurumsallaşma", "evrenselleşme", "yerselleşme", "yerelleşme", "merkezileşme",
      "inovasyon", "motivasyon", "koordinasyon", "regülasyon", "aplikasyon", "sertifikasyon", "manifestasyon", "manipülasyon", "rehabilitasyon", "dezenfeksiyon",
      "multidisipliner", "transdisipliner", "interdisipliner", "konvansiyonel", "entelektüel", "profesyonel", "irrasyonel", "fonksiyonel", "operasyonel", "senkronize",
      "sürdürülebilir", "karşılaştırılabilir", "gerçekleştirilebilir", "özelleştirilebilir", "yönetilebilir", "erişilebilir", "değerlendirilebilir", "görüntülenebilir", "kullanılabilir", "ölçülebilir"
    ]
  };
  
  // Set up event listeners
  startTestBtn.addEventListener('click', startTest);
  restartTestBtn.addEventListener('click', resetTest);
  retryTestBtn.addEventListener('click', resetTest);
  
  inputField.addEventListener('input', handleInput);
  inputField.addEventListener('keydown', preventDefaults);
  
  modeWordsBtn.addEventListener('click', () => setMode('words'));
  modeTimeBtn.addEventListener('click', () => setMode('time'));
  wordsModeRadio.addEventListener('change', () => {
    if (wordsModeRadio.checked) setMode('words');
  });
  timeModeRadio.addEventListener('change', () => {
    if (timeModeRadio.checked) setMode('time');
  });
  
  // Set up word count options
  document.querySelectorAll('[data-words]').forEach(button => {
    button.addEventListener('click', function() {
      document.querySelectorAll('[data-words]').forEach(btn => btn.classList.remove('active'));
      this.classList.add('active');
      testSettings.wordCount = parseInt(this.getAttribute('data-words'));
    });
  });
  
  // Set up time options
  document.querySelectorAll('[data-time]').forEach(button => {
    button.addEventListener('click', function() {
      document.querySelectorAll('[data-time]').forEach(btn => btn.classList.remove('active'));
      this.classList.add('active');
      testSettings.timeLimit = parseInt(this.getAttribute('data-time'));
    });
  });
  
  // Set up difficulty options
  document.querySelectorAll('[data-difficulty]').forEach(button => {
    button.addEventListener('click', function() {
      document.querySelectorAll('[data-difficulty]').forEach(btn => btn.classList.remove('active'));
      this.classList.add('active');
      testSettings.difficulty = this.getAttribute('data-difficulty');
    });
  });
  
  // Set mode (words or time)
  function setMode(mode) {
    testSettings.mode = mode;
    
    if (mode === 'words') {
      modeWordsBtn.classList.add('active');
      modeTimeBtn.classList.remove('active');
      wordsModeRadio.checked = true;
      wordsOption.style.display = 'block';
      timeOption.style.display = 'none';
    } else {
      modeTimeBtn.classList.add('active');
      modeWordsBtn.classList.remove('active');
      timeModeRadio.checked = true;
      timeOption.style.display = 'block';
      wordsOption.style.display = 'none';
    }
  }
  
  // Start the typing test
  function startTest() {
    // Show typing area
    testIntro.style.display = 'none';
    typingTextArea.style.display = 'block';
    resultsScreen.style.display = 'none';
    
    // Reset test state
    testState = {
      started: true,
      completed: false,
      timeLeft: testSettings.timeLimit,
      totalTime: 0,
      timerInterval: null,
      words: [],
      currentWordIndex: 0,
      currentCharIndex: 0,
      correctChars: 0,
      incorrectChars: 0,
      correctWords: 0,
      incorrectWords: 0,
      startTime: Date.now(),
      wpm: 0
    };
    
    // Reset UI
    wpmDisplay.textContent = '0';
    accuracyDisplay.textContent = '100%';
    errorsDisplay.textContent = '0';
    
    // Generate words based on difficulty
    const words = generateWords();
    testState.words = words;
    
    // Display words
    displayWords(words);
    
    // Set timer
    timer.textContent = testSettings.mode === 'time' ? testSettings.timeLimit : '0';
    
    // Start timer
    if (testSettings.mode === 'time') {
      timerFill.style.width = '100%';
      testState.timerInterval = setInterval(updateTimeMode, 1000);
    } else {
      timerFill.style.width = '0%';
      testState.timerInterval = setInterval(updateWordsMode, 1000);
    }
    
    // Focus input field
    inputField.value = '';
    inputField.focus();
  }
  
  // Generate words for the test
  function generateWords() {
    const wordList = wordLists[testSettings.difficulty];
    const words = [];
    const wordCount = testSettings.mode === 'words' ? testSettings.wordCount : 100; // More words for time mode
    
    // Generate random words
    for (let i = 0; i < wordCount; i++) {
      const randomIndex = Math.floor(Math.random() * wordList.length);
      words.push(wordList[randomIndex]);
    }
    
    return words;
  }
  
  // Display words in the typing area
  function displayWords(words) {
    typingText.innerHTML = '';
    
    words.forEach((word, wordIndex) => {
      const wordSpan = document.createElement('span');
      wordSpan.className = 'word';
      
      // Add space after each word except the last one
      const wordWithSpace = wordIndex < words.length - 1 ? word + ' ' : word;
      
      [...wordWithSpace].forEach((char, charIndex) => {
        const charSpan = document.createElement('span');
        charSpan.className = 'char';
        charSpan.textContent = char;
        
        // Highlight the first character at the start
        if (wordIndex === 0 && charIndex === 0) {
          charSpan.classList.add('active');
        }
        
        wordSpan.appendChild(charSpan);
      });
      
      typingText.appendChild(wordSpan);
    });
  }
  
  // Handle input field changes
  function handleInput(e) {
    if (!testState.started || testState.completed) return;
    
    const inputValue = e.target.value;
    const lastChar = inputValue[inputValue.length - 1];
    
    // Get all characters
    const allChars = typingText.querySelectorAll('.char');
    
    // Get current character
    const currentChar = allChars[testState.currentCharIndex];
    const expectedChar = currentChar.textContent;
    
    // Check if the input is a space
    if (lastChar === ' ') {
      // Move to next word
      const currentWord = testState.words[testState.currentWordIndex];
      const typedWord = inputValue.trim();
      
      // Check if the word is correct
      if (typedWord === currentWord) {
        testState.correctWords++;
      } else {
        testState.incorrectWords++;
      }
      
      // Move to next word
      testState.currentWordIndex++;
      
      // Find the starting index of the next word
      let nextWordStartIndex = testState.currentCharIndex + 1;
      while (
        nextWordStartIndex < allChars.length && 
        testState.currentWordIndex < testState.words.length
      ) {
        if (
          allChars[nextWordStartIndex].parentNode !== 
          allChars[testState.currentCharIndex].parentNode
        ) {
          break;
        }
        nextWordStartIndex++;
      }
      
      // Clear current character highlight
      currentChar.classList.remove('active');
      
      // Set new current character index
      testState.currentCharIndex = nextWordStartIndex;
      
      // Highlight new current character if not at the end
      if (testState.currentCharIndex < allChars.length) {
        allChars[testState.currentCharIndex].classList.add('active');
      }
      
      // Clear input field
      inputField.value = '';
      
      // If words mode and all words have been typed, end the test
      if (
        testSettings.mode === 'words' && 
        testState.currentWordIndex >= testSettings.wordCount
      ) {
        completeTest();
      }
      
      return;
    }
    
    // Remove active class from current character
    currentChar.classList.remove('active');
    
    // Check if typed character matches expected character
    if (lastChar === expectedChar) {
      currentChar.classList.add('correct');
      testState.correctChars++;
    } else {
      currentChar.classList.add('incorrect');
      testState.incorrectChars++;
      
      // Update errors display
      errorsDisplay.textContent = testState.incorrectChars;
    }
    
    // Move to next character
    testState.currentCharIndex++;
    
    // Add active class to next character if not at the end
    if (testState.currentCharIndex < allChars.length) {
      allChars[testState.currentCharIndex].classList.add('active');
    }
    
    // Calculate and update stats
    updateStats();
  }
  
  // Prevent default behavior for some keys
  function preventDefaults(e) {
    // Prevent tab key from changing focus
    if (e.key === 'Tab') {
      e.preventDefault();
    }
  }
  
  // Update timer for time mode
  function updateTimeMode() {
    if (testState.timeLeft <= 0) {
      completeTest();
      return;
    }
    
    testState.timeLeft--;
    testState.totalTime++;
    timer.textContent = testState.timeLeft;
    
    // Update progress bar
    const percentage = (testState.timeLeft / testSettings.timeLimit) * 100;
    timerFill.style.width = `${percentage}%`;
    
    // Add warning class when time is running out
    if (testState.timeLeft <= 10) {
      timer.style.color = '#ff4757';
    }
  }
  
  // Update timer for words mode
  function updateWordsMode() {
    testState.totalTime++;
    timer.textContent = testState.totalTime;
    
    // Update progress bar
    const percentage = (testState.currentWordIndex / testSettings.wordCount) * 100;
    timerFill.style.width = `${percentage}%`;
  }
  
  // Calculate and update statistics
  function updateStats() {
    // Calculate elapsed time in minutes
    const elapsedTime = (Date.now() - testState.startTime) / 60000; // Convert ms to minutes
    
    // Calculate WPM: (characters / 5) / time in minutes
    // Using the standard formula where a word is considered to be 5 characters
    const totalChars = testState.correctChars + testState.incorrectChars;
    testState.wpm = Math.round((totalChars / 5) / elapsedTime) || 0;
    
    // Calculate accuracy
    const accuracy = totalChars > 0 
      ? Math.round((testState.correctChars / totalChars) * 100) 
      : 100;
    
    // Update displays
    wpmDisplay.textContent = testState.wpm;
    accuracyDisplay.textContent = `${accuracy}%`;
  }
  
  // Complete the test
  function completeTest() {
    // Stop timer
    clearInterval(testState.timerInterval);
    
    // Mark test as completed
    testState.completed = true;
    
    // Calculate final stats
    const elapsedTime = testState.totalTime;
    const totalChars = testState.correctChars + testState.incorrectChars;
    const accuracy = totalChars > 0 
      ? Math.round((testState.correctChars / totalChars) * 100) 
      : 100;
    
    // Convert seconds to minutes:seconds format
    const minutes = Math.floor(elapsedTime / 60);
    const seconds = elapsedTime % 60;
    const timeString = `${minutes}:${seconds.toString().padStart(2, '0')}`;
    
    // Update results screen
    resultWpm.textContent = testState.wpm;
    resultAccuracy.textContent = `${accuracy}%`;
    resultCharacters.textContent = totalChars;
    resultCorrectChars.textContent = testState.correctChars;
    resultCorrectWords.textContent = testState.correctWords;
    resultErrors.textContent = testState.incorrectChars;
    resultWrongWords.textContent = testState.incorrectWords;
    resultTimeUsed.textContent = timeString;
    
    // Set performance bar
    setPerformanceBar(testState.wpm);
    
    // Show results screen
    typingTextArea.style.display = 'none';
    resultsScreen.style.display = 'block';
  }
  
  // Set performance bar and message
  function setPerformanceBar(wpm) {
    let percentage = 0;
    let message = '';
    
    if (wpm < 20) {
      percentage = 20;
      message = 'Gelişmeye açık bir performans. Düzenli pratik yaparak hızınızı artırabilirsiniz.';
    } else if (wpm < 40) {
      percentage = 40;
      message = 'Ortalama bir yazma hızınız var. Pratik yaparak hızınızı artırabilirsiniz.';
    } else if (wpm < 60) {
      percentage = 60;
      message = 'İyi bir yazma hızınız var! Kendinizi geliştirmeye devam edin.';
    } else if (wpm < 80) {
      percentage = 80;
      message = 'Çok iyi bir yazma hızınız var! Profesyonel seviyeye yaklaşıyorsunuz.';
    } else {
      percentage = 100;
      message = 'Mükemmel bir yazma hızınız var! Profesyonel seviyedesiniz.';
    }
    
    // Animate performance bar
    setTimeout(() => {
      performanceBar.style.width = `${percentage}%`;
    }, 500);
    
    performanceMessage.textContent = message;
  }
  
  // Reset the test
  function resetTest() {
    // Clear timer
    clearInterval(testState.timerInterval);
    
    // Reset test state
    testState = {
      started: false,
      completed: false,
      timeLeft: testSettings.timeLimit,
      totalTime: 0,
      timerInterval: null,
      words: [],
      currentWordIndex: 0,
      currentCharIndex: 0,
      correctChars: 0,
      incorrectChars: 0,
      correctWords: 0,
      incorrectWords: 0,
      startTime: 0,
      wpm: 0
    };
    
    // Reset UI
    wpmDisplay.textContent = '0';
    accuracyDisplay.textContent = '100%';
    errorsDisplay.textContent = '0';
    timer.textContent = testSettings.mode === 'time' ? testSettings.timeLimit : '0';
    timer.style.color = '';
    
    // Show intro screen
    testIntro.style.display = 'block';
    typingTextArea.style.display = 'none';
    resultsScreen.style.display = 'none';
  }
});
</script>
{% endblock %}