{% extends 'base.html' %}
{% block title %}Sesli Hafıza: Melodi - Beyin Geliştirici Hafıza Oyunu{% endblock %}

{% block styles %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/audio-memory.css') }}">
{% endblock %}

{% block content %}
<div class="container mt-4 mb-5 audio-memory-container">
  <!-- Oyun Başlık Bölümü -->
  <div class="audio-memory-header">
    <h1 class="game-title">
      <i class="bi bi-music-note-beamed"></i> Sesli Hafıza: Melodi
    </h1>
    <div class="game-stats-row">
      <div class="game-stat-horizontal">
        <i class="bi bi-star-fill"></i>
        <span class="stat-label">Skor:</span>
        <span class="stat-value" id="score">0</span>
      </div>
      <div class="game-stat-horizontal">
        <i class="bi bi-layers-fill"></i>
        <span class="stat-label">Seviye:</span>
        <span class="stat-value" id="level">1</span>
      </div>
      <div class="game-stat-horizontal">
        <i class="bi bi-stopwatch"></i>
        <span class="stat-label">Süre:</span>
        <span class="stat-value" id="timer">00:00</span>
      </div>
    </div>
  </div>

  <!-- Giriş Ekranı -->
  <div id="gameIntro">
    <div class="audio-memory-intro">
      <h2 class="instruction-title">
        <i class="bi bi-info-circle-fill"></i> Oyun Kuralları
      </h2>
      <p>Sesli Hafıza: Melodi, hafızanızı ve dikkatinizi geliştiren profesyonel bir hafıza oyunudur. Kutuların çalma sırasını izleyin ve ardından aynı sırayla tekrarlayın.</p>
      
      <div class="instruction-steps">
        <div class="instruction-step">
          <div class="step-number">1</div>
          <div class="step-text">Renkli kutular belirli bir sırayla sesler çıkaracak ve yanıp sönecek.</div>
        </div>
        <div class="instruction-step">
          <div class="step-number">2</div>
          <div class="step-text">Sırayı dikkatlice izleyin ve sıra size geldiğinde aynı sırayı tekrarlayın.</div>
        </div>
        <div class="instruction-step">
          <div class="step-number">3</div>
          <div class="step-text">Her seviye başarıyla tamamlandığında, sıraya yeni bir adım eklenir.</div>
        </div>
        <div class="instruction-step">
          <div class="step-number">4</div>
          <div class="step-text">Yanlış bir kutuya basarsanız veya sırayı unutursanız oyun sona erer.</div>
        </div>
      </div>
      
      <div class="row mt-4">
        <div class="col-md-6 mb-4">
          <div class="audio-memory-settings">
            <h3 class="level-label">
              <i class="bi bi-speedometer2"></i> Zorluk Seviyesi
            </h3>
            <div class="level-buttons">
              <button class="level-btn active" data-level="easy">Kolay (4 Kutu)</button>
              <button class="level-btn" data-level="medium">Orta (6 Kutu)</button>
              <button class="level-btn" data-level="hard">Zor (8 Kutu)</button>
            </div>
          </div>
        </div>
        
        <div class="col-md-6 mb-4">
          <div class="audio-memory-settings">
            <h3 class="level-label">
              <i class="bi bi-music-note"></i> Ses Teması
            </h3>
            <div class="theme-buttons">
              <button class="theme-btn active" data-theme="electronic">Elektronik</button>
              <button class="theme-btn" data-theme="musical">Müzikal</button>
              <button class="theme-btn" data-theme="drums">Davul</button>
            </div>
          </div>
        </div>
      </div>
      
      <div class="row">
        <div class="col-md-6 mb-4">
          <div class="audio-memory-settings">
            <h3 class="level-label">
              <i class="bi bi-sliders"></i> Oyun Modları
            </h3>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="speedMode">
              <label class="form-check-label" for="speedMode">Hız Modu - Daha hızlı tempo, daha fazla zorluk</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="bonusMode" checked>
              <label class="form-check-label" for="bonusMode">Combo Modu - Art arda doğru diziler için puan çarpanı</label>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="audio-memory-controls">
      <button id="startGame" class="play-btn">
        <i class="bi bi-play-fill"></i> Oyunu Başlat
      </button>
    </div>
  </div>

  <!-- Oyun Tahtası -->
  <div id="gameBoard" style="display: none;">
    <div class="audio-memory-board">
      <div class="board-header">
        <h3 class="current-level" id="currentLevelDisplay">Seviye 1</h3>
        <div class="game-controls-top">
          <button id="pauseGame" class="game-control-btn" title="Oyunu Duraklat">
            <i class="bi bi-pause-fill"></i>
          </button>
          <button id="soundToggle" class="game-control-btn" title="Sesi Aç/Kapat">
            <i class="bi bi-volume-up-fill"></i>
          </button>
        </div>
      </div>
      
      <div class="status-message">
        <span id="statusText">Sırayı İzleyin...</span>
        <div class="status-progress">
          <div class="status-progress-bar" id="statusProgressBar"></div>
        </div>
      </div>
      
      <div id="tilesContainer" class="tiles-container"></div>
      
      <div class="audio-memory-progress">
        <div class="progress-label">
          <span>İlerleme</span>
          <span id="progressPercent">0%</span>
        </div>
        <div class="progress">
          <div class="progress-bar" id="progressBar" style="width: 0%"></div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Sonuç Ekranı -->
  <div id="gameResults" class="audio-memory-results" style="display: none;">
    <div class="results-card">
      <div class="results-header">
        <div class="result-badge">
          <i class="bi bi-trophy-fill"></i>
        </div>
        <h2>Oyun Sona Erdi!</h2>
      </div>
      
      <div class="results-stats">
        <div class="result-stat">
          <div class="result-stat-value" id="finalScore">0</div>
          <div class="result-stat-label">Toplam Puan</div>
        </div>
        <div class="result-stat">
          <div class="result-stat-value" id="finalLevel">0</div>
          <div class="result-stat-label">Seviye</div>
        </div>
        <div class="result-stat">
          <div class="result-stat-value" id="finalTime">00:00</div>
          <div class="result-stat-label">Süre</div>
        </div>
      </div>
      
      <div class="performance-rating">
        <div class="rating-stars" id="performanceStars">
          <i class="bi bi-star-fill" style="--i: 0"></i>
          <i class="bi bi-star-fill" style="--i: 1"></i>
          <i class="bi bi-star-fill" style="--i: 2"></i>
          <i class="bi bi-star" style="--i: 3"></i>
          <i class="bi bi-star" style="--i: 4"></i>
        </div>
        <div class="rating-text" id="performanceText">İyi Performans!</div>
      </div>
      
      <div class="results-footer">
        <button id="playAgainBtn" class="btn-outline-light">
          <i class="bi bi-arrow-repeat"></i> Tekrar Oyna
        </button>
        <button id="saveScoreBtn" class="btn-primary">
          <i class="bi bi-save"></i> Skoru Kaydet
        </button>
      </div>
    </div>
  </div>
  
  <!-- Duraklatma Ekranı -->
  <div id="pauseOverlay" class="game-pause-overlay" style="display: none;">
    <div class="pause-card">
      <h3><i class="bi bi-pause-circle-fill"></i> Oyun Duraklatıldı</h3>
      <p>Oyuna devam etmek için aşağıdaki butona tıklayın.</p>
      <button id="resumeBtn" class="btn-primary">
        <i class="bi bi-play-fill"></i> Devam Et
      </button>
    </div>
  </div>
  
  <!-- Uyarı Mesajları -->
  <div id="gameAlerts" class="audio-memory-alert"></div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/audio-memory.js') }}"></script>
{% endblock %}