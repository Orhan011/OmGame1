{% extends 'layout.html' %}

{% block title %}Sesli Hafıza - ZekaPark{% endblock %}

{% block content %}
<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-lg-10">
      <!-- Giriş ekranı -->
      <div id="audio-memory-intro" class="memory-intro">
        <div class="row">
          <div class="col-md-8">
            <h2 class="section-title mb-4">Sesli Hafıza Oyunu</h2>
            <div class="game-instructions mb-md-0">
              <h4 class="instruction-title"><i class="fas fa-music me-2"></i>Nasıl Oynanır?</h4>
              <p>Hafızanı ve kulak duyunu test et! Oyun sana bir ses dizisi çalacak. Senin görevin bu diziyi aynı sırayla tekrarlamak.</p>
              <div class="memory-tips mt-3">
                <div class="tip-badge">
                  <i class="fas fa-lightbulb"></i>
                  <span>İpucu: Sesleri hecelere veya melodilere dönüştürerek daha kolay hatırlayabilirsin</span>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-4 text-center text-md-end mt-3 mt-md-0">
            <div class="memory-levels-selector">
              <div class="level-label">Zorluk</div>
              <div class="level-buttons">
                <button id="level-easy" class="level-btn active" data-level="EASY">Kolay</button>
                <button id="level-medium" class="level-btn" data-level="MEDIUM">Orta</button>
                <button id="level-hard" class="level-btn" data-level="HARD">Zor</button>
              </div>
            </div>
            <button id="start-button" class="btn btn-primary btn-lg pulse-animation mt-3">
              <i class="fas fa-play me-2"></i>Oyunu Başlat
            </button>
          </div>
        </div>
      </div>

      <!-- Oyun ekranı -->
      <div id="audio-memory-game" class="memory-game-container" style="display: none;">
        <!-- Oyun Başlığı ve İstatistikler -->
        <div class="memory-header">
          <h3><i class="fas fa-music me-2"></i>Sesli Hafıza</h3>
          <div class="game-controls-top">
            <button class="game-control-btn" id="pause-button" title="Oyunu Duraklat">
              <i class="fas fa-pause"></i>
            </button>
            <button class="game-control-btn" id="sound-toggle" title="Sesi Aç/Kapat">
              <i class="fas fa-volume-up"></i>
            </button>
          </div>
        </div>

        <!-- Oyun İstatistikleri -->
        <div class="game-stats">
          <div class="game-stat">
            <i class="fas fa-medal"></i>
            <div class="stat-label">Puan</div>
            <div class="stat-value" id="score-value">0</div>
          </div>
          <div class="game-stat">
            <i class="fas fa-check-circle"></i>
            <div class="stat-label">Doğruluk</div>
            <div class="stat-value" id="correct-value">0/0 (0%)</div>
          </div>
          <div class="game-stat">
            <i class="fas fa-layer-group"></i>
            <div class="stat-label">Seviye</div>
            <div class="stat-value" id="level-value">1</div>
          </div>
        </div>

        <!-- Durum Göstergesi -->
        <div id="sequence-status" class="sequence-status">
          <div class="countdown-display">Hazır olduğunuzda başlayın...</div>
        </div>

        <!-- Ses Butonları -->
        <div class="audio-pads-grid">
          <button class="audio-pad" data-note="C4" style="background-color: #2196F3;">
            <i class="fas fa-music"></i>
          </button>
          <button class="audio-pad" data-note="E4" style="background-color: #4CAF50;">
            <i class="fas fa-music"></i>
          </button>
          <button class="audio-pad" data-note="G4" style="background-color: #F44336;">
            <i class="fas fa-music"></i>
          </button>
          <button class="audio-pad" data-note="B4" style="background-color: #FF9800;">
            <i class="fas fa-music"></i>
          </button>
          <button class="audio-pad" data-note="D5" style="background-color: #9C27B0;">
            <i class="fas fa-music"></i>
          </button>
          <button class="audio-pad" data-note="F5" style="background-color: #FFEB3B;">
            <i class="fas fa-music"></i>
          </button>
        </div>

        <!-- Oyun Kontrolleri -->
        <div class="memory-controls">
          <button id="play-sequence" class="btn btn-primary">
            <i class="fas fa-play me-2"></i>Diziyi Tekrar Çal
          </button>
        </div>
      </div>

      <!-- Oyun Sonuç Ekranı -->
      <div id="game-over-screen" class="memory-results-container" style="display: none;">
        <div class="memory-results">
          <div class="memory-results-header">
            <h2><i class="fas fa-trophy me-2"></i>Oyun Bitti!</h2>
          </div>
          <div class="memory-results-content">
            <div class="final-score-display">
              <div class="final-score-label">Skorunuz</div>
              <div class="final-score" id="final-score">0</div>
            </div>
            <div class="score-breakdown">
              <div class="stat-item">
                <div class="stat-icon"><i class="fas fa-brain"></i></div>
                <div class="stat-info">
                  <div class="stat-name">Hafıza Gücü</div>
                  <div class="progress">
                    <div class="progress-bar" role="progressbar" style="width: 75%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
                  </div>
                </div>
              </div>
              <div class="stat-item">
                <div class="stat-icon"><i class="fas fa-hourglass-half"></i></div>
                <div class="stat-info">
                  <div class="stat-name">Reaksiyon Süresi</div>
                  <div class="progress">
                    <div class="progress-bar" role="progressbar" style="width: 60%" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="memory-results-footer">
            <div class="result-actions">
              <button id="restart-button" class="btn btn-primary">
                <i class="fas fa-redo me-2"></i>Yeniden Oyna
              </button>
              <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">
                <i class="fas fa-home me-2"></i>Ana Sayfa
              </a>
            </div>
            <div class="share-section">
              <p>Skorunuzu paylaşın:</p>
              <div class="share-buttons">
                <button class="share-btn" title="Kopyala" id="copy-score">
                  <i class="fas fa-copy"></i>
                </button>
                <button class="share-btn" title="Paylaş" id="share-score">
                  <i class="fas fa-share-alt"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Duraklat Menüsü Overlay -->
      <div id="pause-overlay" class="pause-overlay" style="display: none;">
        <div class="pause-card">
          <h3><i class="fas fa-pause me-2"></i>Oyun Duraklatıldı</h3>
          <p>Devam etmek için aşağıdaki düğmeye tıklayın.</p>
          <div class="pause-menu-buttons">
            <button id="resume-game" class="btn btn-primary">
              <i class="fas fa-play me-2"></i>Devam Et
            </button>
            <button id="restart-game" class="btn btn-outline-primary">
              <i class="fas fa-redo me-2"></i>Yeniden Başlat
            </button>
            <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">
              <i class="fas fa-home me-2"></i>Ana Sayfa
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.26/Tone.js"></script>
<script src="{{ url_for('static', filename='js/games/audioMemory.js') }}"></script>
{% endblock %}